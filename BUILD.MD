# Требования к программному обеспечению

Для сборки инсталлятора пакета понадобятся:

- Установленный в системе интерпретатор Python 2.7 - x86 и переменная *%PY27-32PATH%* с полным путём к его каталогу
- Установленное дополнение для Python 2.7 PyInstaller-3.6
- Установленный компилятор Visual C for Python 2.7 (Microsoft)
- Установленный в системе  Wix Toolset последней версии
- Установленный в системе WixEdit последней версии
- Доступ к диску C: с повышенными привилегиями.

Программы можно скачать с официальных репозиториев, сайта автора, некоторые пакеты можно установить через менеджер пакетов chocolatey

## Особенности установки PyInstaller-3.6

PyInstaller 3.6 — последняя версия расширения pyinstaller, поддерживаемая дистрибутивом Python 2.7, уже официально не поддерживаемым. Чтобы установить расширение, необходимо:

- Скачать файл PyInstaller-3.6.tar.gz в рабочую папку
- Распаковать полученный архив в текущую папку и перейти в каталог PyInstaller-3.6
- Выполнить там следующую команду:

```
     %PY27-32PATH%\python.exe .\setup.py install
```

- Дождаться оканчания установки.
- Теперь в каталоге Python будет находиться файл *%PY27-32PATH%\Scripts\pyinstaller.exe*. В дальнейшем он будет использоваться для создания исполняемых файлов python.

# Компилирование файлов Python

Просто запустите в каталоге с файлами **.py* командный файл *build.bat* или *build-test.bat*. Отличие между этими файлами в том, что второй выводит тестовый вывод работы приложения в консоль, поэтому он предпочтительней для отладки.

# Создание шифрованного base64 ini Файла

Для корректной работы приложения необходимо правильно сформировать файл *settings-reverse.ini*. Дефолтные настройки приведены только для примера, с ними программа работать не будет. Для создания правильного файла необходимо:

- Перейти в каталог *.\NIt.ConfigFileMaker* и исправить данные в файле *NIT.ConfigMaker.py*. Скорее всего, Вам придётся исправить ip адрес хоста, логины и пароли.
- Выполнить команду:
``` 
    %PY27-32PATH%\python.exe .\NIT.ConfigMaker.py
```
- Программа создаст каталог *c:\pub1\Util* с нужным файлом. Необходимо скопировать его с заменой в каталог *.\pub1\Util*.
- После этого можно собирать инсталлер.

# Создание инсталлятора

- Откройте файл *.\NIT-Scheduler.wxs* в программе Wix Editor
- Выберите в меню Build -> Build MSI Setup package
- Дождитесь создания инсталлятора

Сгенерируется MSI инсталлятор, который можно устанавливать стандартными способами Microsoft Windows, в том числе скрытно и с использованием групповых политик.
